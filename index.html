<!DOCTYPE html>

<html>

	<head>

		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		<title>SITY Challenge</title>

		<!-- Font Awesome -->
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
		<!-- Bootstrap core CSS -->
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
		<!-- Material Design Bootstrap -->
		<link href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.8.3/css/mdb.min.css" rel="stylesheet">
		
		<!--CSS Style/Fonts-->
		<link href="./style.css" type="text/css" rel="stylesheet">
		<link href='http://fonts.googleapis.com/css?family=Lato&subset=latin,latin-ext' rel='stylesheet' type='text/css'>
		<link rel="icon" type="image/png" sizes="16x16" href="https://www.sityinc.com/images/favicon-32x32.png">

	</head>

	<body onload="initMap()">

		<!-- Bootstrap core JavaScript -->
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script>
		<!-- JQuery -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
		<!-- Bootstrap tooltips -->
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.4/umd/popper.min.js"></script>
		<!-- MDB core JavaScript -->
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.8.3/js/mdb.min.js"></script>

		<!--TEMP-->
		<script>

		</script>

		<div class="wrapper">

			<!--Page Header-->
			<div class="container">

				<nav class="navbar navbar-dark navbar-expand-lg fixed-top intro-hide" id="header">
					<a class="navbar-brand intro-show" href="https://github.com/Ivo-Andrade/SITYchallenge" target="_blank">
						<img class="mx-2" src="https://www.sityinc.com/images/logo-default.png" id="logo"/>
					</a>

					<div class="d-md-flex flex-column nowrap d-lg-none" id="searchBarMobile">
						<div class="d-sm-none d-md-none" id="brands">
							<a class="fa fa-lg fa-facebook navbar-brand" href="https://www.facebook.com/SITYINC/" target="_blank"></a>
							<a class="fa fa-lg fa-twitter navbar-brand" href="https://twitter.com/sityoficial" target="_blank"></a>
							<a class="fa fa-lg fa-instagram navbar-brand" href="https://www.instagram.com/sityoficial/?igshid=eabln2gnfkat" target="_blank"></a>
						</div>
						<div id="form">
		    				<div class="input-group">
								<input type="text" class="form-control" id="headerSearchBarMobile" aria-label="Large" aria-describedby="inputGroup-sizing-sm" placeholder="Vamos para...">
							</div>
	    				</div>
					</div>

					<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation" id="toggleButton">
						<span class="navbar-toggler-icon"></span>
					</button>
					<div class="collapse navbar-collapse justify-content-between" id="navbarNav">
						<div class="navbar-nav">
							<a class="nav-item nav-link active" href="https://www.sityinc.com" target="_blank">Home<span class="sr-only"></span></a>
							<a class="nav-item nav-link active" href="https://www.sityinc.com/motorista" target="_blank">Motorista</a>
							<a class="nav-item nav-link active" href="https://www.sityinc.com/passageiro" target="_blank">Passageiro</a>
							<a class="nav-item nav-link active" href="https://www.sityinc.com/corporativo" target="_blank">Empresa</a>
							<li class="nav-item dropdown d-none d-lg-block">
								<a class="nav-link dropdown-toggle active" href="https://www.sityinc.com/nos" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" target="_blank">Sobre Nós</a>
								<div class="dropdown-menu bg-customNavbar" aria-labelledby="navbarDropdownMenuLink" id="navbarDropdown">
									<a class="nav-item nav-link active" href="https://www.sityinc.com/nos" target="_blank">Quem Somos</a>
									<a class="nav-item nav-link active" href="https://www.sityinc.com/nos#news" target="_blank">News</a>
									<a class="nav-item nav-link active" href="https://www.sityinc.com/nos#!" target="_blank">Trabalhe Conosco</a>
								</div>
							</li>
							<a class="nav-item nav-link active d-block d-lg-none" href="https://www.sityinc.com/corporativo" target="_blank">Sobre Nós</a>
						</div>
						<div class="d-none d-lg-flex nowrap" id="searchBar">
							<div class="d-flex flex-row nowrap" id="brands">
								<a class="fa fa-facebook navbar-brand" href="https://www.facebook.com/SITYINC/" target="_blank"></a>
								<a class="fa fa-twitter navbar-brand" href="https://twitter.com/sityoficial" target="_blank"></a>
								<a class="fa fa-instagram navbar-brand" href="https://www.instagram.com/sityoficial/?igshid=eabln2gnfkat" target="_blank"></a>
							</div>
							<div id="form">
			    				<div class="input-group">
									<input type="text" class="form-control" id="headerSearchBar" aria-label="Large" aria-describedby="inputGroup-sizing-sm" placeholder="Vamos para...">
								</div>
		    				</div>
						</div>
	    			</div>
				</nav>
			</div>

			<!--div for Google Maps-->
			<div id="map"></div>

			<!-- div for Instructions Panel-->
			<div id="panel" class="fixed m-1"></div>

			<!--Placeholder in case Maps don't show up-->
			<div class="d-flex flex-column justify-content-center align-items-center" id="alert">
				<h1 class="text-center intro-hide" id="alertText">Permita o serviço de geolocalização do seu aparelho e navegador para obter sua rota!</h1>
			</div>

			<!--Intro div -->
			<div class="d-flex flex-column justify-content-center align-items-center  intro-startingPos" id="welcomeIntro">
				<h1 class="text-center" id="welcomeText">Para onde vamos?</h1>
				<input type="text" class="form-control" id="welcomeInput" aria-label="Large" aria-describedby="inputGroup-sizing-sm" placeholder="Vamos para...">
				<button class="btn btn-lg btn-info active-primary m-3" type="button" id="welcomeButton" onclick="calcRoute(document.getElementById('welcomeInput'))">Vamos!</button>
			</div>

			<!--Script for the Google Maps app-->
			<script type="text/javascript">

				var latitude = null;                    
				var longitude = null;                 
				var coords = null;

				var map;

				function initMap() {

					if (navigator.geolocation) {
						navigator.geolocation.getCurrentPosition(function (position) {

							latitude = position.coords.latitude;                    
							longitude = position.coords.longitude;                 
							coords = new google.maps.LatLng(latitude, longitude);        
					
							var mapOptions =
							{
								zoom: 15,
								center: coords,
								disableDefaultUI: true,
								zoomControl: true,
								navigationControlOptions:
								{
									style: google.maps.NavigationControlStyle.SMALL
								},
								mapTypeId: google.maps.MapTypeId.ROADMAP
							};

							map = new google.maps.Map(document.getElementById("map"), mapOptions);

						},
						function(error) {
						    if (error.code == error.PERMISSION_DENIED) {
							   alert("Permita o serviço de geolocalização do seu aparelho e navegador para obter sua rota!");
	  						}
						});
					}
					else
					{
					   window.alert("Geolocation API is not supported in your browser.");
					}

					var welcomeInput = document.getElementById("welcomeInput");
					welcomeInput.addEventListener("keyup", function(event) {
						if (event.keyCode === 13) {
							event.stopPropagation();
							event.preventDefault();
							document.getElementById("welcomeButton").click();
						}
					});

					var navbarInput = document.getElementById("headerSearchBar");
					navbarInput.addEventListener("keyup", function(event) {
						if (event.keyCode === 13) {
							event.stopPropagation();
							event.preventDefault();
							calcRoute(document.getElementById("headerSearchBar"));
						}
					})

					var navbarMobileInput = document.getElementById("headerSearchBarMobile");
					navbarMobileInput.addEventListener("keyup", function(event) {
						if (event.keyCode === 13) {
							event.stopPropagation();
							event.preventDefault();
							calcRoute(document.getElementById("headerSearchBarMobile"));
						}
					})
				}

				function calcRoute(end) {
					if(coords === null){
						alert("Permita o serviço de geolocalização do seu aparelho e navegador para obter sua rota!");
					}
					else{

						var directionsService = new google.maps.DirectionsService();
						var directionsDisplay = new google.maps.DirectionsRenderer();
						var mapOptions =
						{
							zoom: 15,
							center: coords,
							disableDefaultUI: true,
							zoomControl: true,
							navigationControlOptions:
							{
								style: google.maps.NavigationControlStyle.SMALL
							},
							mapTypeId: google.maps.MapTypeId.ROADMAP
						};
						
						map = new google.maps.Map(document.getElementById("map"), mapOptions);
						directionsDisplay.setMap(map);
						directionsDisplay.setPanel(document.getElementById('panel'));

						var request = {
							origin: coords,
							destination: end.value,
							travelMode: google.maps.DirectionsTravelMode.DRIVING
						};

						directionsService.route(request, function (response, status) {
							if (status == google.maps.DirectionsStatus.OK) {
								directionsDisplay.setDirections(response);
							}
 							else {
					        	window.alert('Directions request failed due to ' + status);
					        }
						});
					}
				}

			</script>
			<!--script to summon Google Maps-->
			<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAxfcO1YshS2zReHmTd_tud547lXxnprf4&callback=initMap">
	    	</script>

	    	<!--Page Footer-->
			<footer class="fixed-bottom my-1 intro-hide">
				<div class="d-flex flex-lg-row justify-content-center align-items-center" id="footer">
					<p class="text-nowrap mr-1">Project by Ivo de Andrade de Deus.</p>
					<p class="text-nowrap">Map Icon by The Noun Project.</p>
				</div>
			</footer>

		</div>

		<!--Animation Scripts-->
		<script>
			//animated intro
			$("#welcomeText, #welcomeInput, #welcomeButton").addClass("animated fadeIn zoomInDown");
			$("#welcomeButton").click(function(){
				$("#welcomeText, #welcomeInput, #welcomeButton").removeClass("animated fadeIn zoomInDown slow");
				$("#header, footer, #alertText").removeClass("intro-hide");
				$("#welcomeIntro").addClass("animated fadeOut");
				$("#header, footer, #alertText").addClass("animated fadeIn");
				$("#welcomeIntro").addClass("intro-hide").delay(200);
			});
			$('.dropdown').on('show hide', function() {
			    $('#header').css('height', '0px');
			});
		</script>

		<!--BootStrap JS-->
		<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
		<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

	</body>

<html>